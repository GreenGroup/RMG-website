{% extends "base.html" %}
{% load gravatar %}
{% load databasefilters %}



{% block title %}RMG: Regression Tests{% endblock %}

{% block extrahead %}
<!-- Angular Material style sheet -->
  <link rel="stylesheet" type="text/css" href="/static/js/angular/angular-material.min.css">

  <!-- Angular Material requires Angular.js Libraries -->
  <script src="/static/js/angular/angular.min.js"></script>
  <script src="/static/js/angular/angular-animate.min.js"></script>
  <script src="/static/js/angular/angular-aria.min.js"></script>
  <script src="/static/js/angular/angular-messages.min.js"></script>

  <!-- Angular Material Library -->
  <script src="/static/js/angular/angular-material.min.js"></script>

  <script src="/static/js/regression_tests.js"></script>

{% endblock %}


{% block navbar_items %}
<a href="{% url 'regression_tests.views.index' %}">Regression Tests</a>
{% endblock %}

{% block page_title %}Regression Tests{% endblock %}

{% block page_body %}

<div ng-controller="BranchSelectorController as ctrl" layout="column" ng-cloak ng-app="branch_selector">
  <md-content class="layout-padding">
    <form method="POST" name="regressionTestsForm" action="../regression_tests/add_job">
      {% csrf_token %}

      <div layout-gt-sm="row">
          <md-autocomplete flex required
              md-input-name="autocompleteField_py"
              md-input-minlength="2"
              md-input-maxlength="18"
              md-no-cache="ctrl.noCache"
              md-selected-item="ctrl.selected_branch_rmgpy"
              md-search-text="ctrl.search_text_rmgpy"
              md-items="branch_rmgpy in ctrl.querySearch(ctrl.search_text_rmgpy, ctrl.branches_rmgpy)"
              md-item-text="branch_rmgpy.display"
              md-require-match
              md-floating-label="RMG-Py Branch">
            <md-item-template>
              <span md-highlight-text="ctrl.search_text_rmgpy">{/{branch_rmgpy.display}/}</span>
            </md-item-template>
            <div ng-messages="regressionTestsForm.autocompleteField_py.$error" ng-if="regressionTestsForm.autocompleteField_py.$touched">
              <div ng-message="required">You <b>must</b> select a branch.</div>
              <div ng-message="md-require-match">Please select an existing branch.</div>
              <div ng-message="minlength">Your entry is not long enough.</div>
              <div ng-message="maxlength">Your entry is too long.</div>
            </div>
          </md-autocomplete>

          <md-autocomplete flex required
              md-input-name="autocompleteField_db"
              md-input-minlength="2"
              md-input-maxlength="18"
              md-no-cache="ctrl.noCache"
              md-selected-item="ctrl.selected_branch_rmgdb"
              md-search-text="ctrl.search_text_rmgdb"
              md-items="branch_rmgdb in ctrl.querySearch(ctrl.search_text_rmgdb, ctrl.branches_rmgdb)"
              md-item-text="branch_rmgdb.display"
              md-require-match
              md-floating-label="RMG-database Branch">
            <md-item-template>
              <span md-highlight-text="ctrl.search_text_rmgdb">{/{branch_rmgdb.display}/}</span>
            </md-item-template>
            <div ng-messages="regressionTestsForm.autocompleteField_db.$error" ng-if="regressionTestsForm.autocompleteField_db.$touched">
              <div ng-message="required">You <b>must</b> select a branch.</div>
              <div ng-message="md-require-match">Please select an existing branch.</div>
              <div ng-message="minlength">Your entry is not long enough.</div>
              <div ng-message="maxlength">Your entry is too long.</div>
            </div>
          </md-autocomplete>
      </div>

      <div>
        <md-button type="submit" class="md-raised md-primary">Submit</md-button>
      </div>
    </form>
  </md-content>
</div>

<md-content class="layout-padding">
      <md-list flex>
      <md-subheader class="md-no-sticky">Job Queue</md-subheader>
      {% for job in jobs %}
        <md-list-item class="md-3-line" ng-click="null" aria-label="Show Job List">
          <div class="md-list-item-text" layout="column">
            <h3>{{ job.rmgpy_branch }}</h3>
            <h4>{{ job.rmgdb_branch }}</h4>
            <p>RMG dev</p>
          </div>
          {% with "/static/img/icons/"|add:job.job_status|add:".png" as status %}
            <img class='job-status-img' id="{{ job.id }}" src="{{ status }}" style="max-width: 20px;"/>
          {% endwith %}
        </md-list-item>
      {% endfor %}
      </md-list>

    <md-content>

{% endblock %}
